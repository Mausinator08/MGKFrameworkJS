"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Create = exports.HumanView = void 0;
const game_core_js_1 = require("./../game/game-core.js");
class HumanView {
    constructor(name) {
        this.name = "HumanView";
        this.type = "HumanView";
        this.autoUpdate = false;
        this.reInit = true;
        this.requestShutdown = false;
        this.rendererName = "";
        this.isInitialized = false;
        this.clearColor = {
            r: 0.0,
            g: 0.0,
            b: 0.0,
            a: 0.0
        };
        this.name = name;
    }
    VInit() {
        let renderer = game_core_js_1.GameCore.game.comMan.GetByName(this.rendererName);
        renderer.CreateScene(function (scene, canvas) {
            let defaultCamera = new BABYLON.FreeCamera("camera_default", new BABYLON.Vector3(0, 5, -10), scene);
            defaultCamera.setTarget(BABYLON.Vector3.Zero());
            defaultCamera.attachControl(canvas, true);
            return scene;
        });
        this.isInitialized = true;
        this.reInit = false;
        return true;
    }
    VUpdate() {
        if (game_core_js_1.GameCore.game.Quitting() === true) {
            this.requestShutdown = true;
        }
        if (this.isInitialized === false) {
            console.warn("HumanView: VUpdate() -> The human view [" + this.name + "] called update without being initialized!\n" +
                "Call the VInit() function and ensure it returns true before calling VUpdate().");
            return;
        }
        let renderer = game_core_js_1.GameCore.game.comMan.GetByName(this.rendererName);
        if (renderer.IsInitialized === false) {
            console.warn("HumanView: VUpdate() -> The human view has detected that the renderer is not initialized!");
            return;
        }
        // Grab and clear the background color to start the scene rendering.
        let cc = this.clearColor;
        renderer.BeginScene(cc.r, cc.g, cc.b, cc.a);
        // Render objects here:
        // End rendering objects...
        // Call this to end the rendering scene and present it to the screen.
        renderer.EndScene();
    }
    VShutdown() {
        if (this.requestShutdown === true) {
            this.isInitialized = false;
            this.requestShutdown = false;
        }
    }
    VIsInitialized() {
        return this.isInitialized;
    }
    VReInit() {
        this.reInit = true;
    }
    VIsReInit() {
        return this.reInit;
    }
    VShutdownRequested() {
        return this.requestShutdown;
    }
    VRequestShutdown() {
        this.requestShutdown = true;
    }
    SetBackgroundColor(r, g, b, a) {
        this.clearColor.r = r;
        this.clearColor.g = g;
        this.clearColor.b = b;
        this.clearColor.a = a;
    }
    SetRendererName(name) {
        this.rendererName = name;
    }
}
exports.HumanView = HumanView;
function Create(name) {
    return new HumanView(name);
}
exports.Create = Create;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHVtYW4tdmlldy5qcyIsInNvdXJjZVJvb3QiOiIuLy4uLyIsInNvdXJjZXMiOlsiTUdLRnJhbWV3b3JrSlMvc3JjL2dhbWUtdmlld3MvaHVtYW4tdmlldy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFFQSx5REFBa0Q7QUFFbEQsTUFBYSxTQUFTO0lBRWxCLFlBQVksSUFBWTtRQXlGakIsU0FBSSxHQUFXLFdBQVcsQ0FBQztRQUMzQixTQUFJLEdBQVcsV0FBVyxDQUFDO1FBQzNCLGVBQVUsR0FBWSxLQUFLLENBQUM7UUFDNUIsV0FBTSxHQUFZLElBQUksQ0FBQztRQUN2QixvQkFBZSxHQUFZLEtBQUssQ0FBQztRQUNoQyxpQkFBWSxHQUFXLEVBQUUsQ0FBQztRQUMxQixrQkFBYSxHQUFZLEtBQUssQ0FBQztRQUMvQixlQUFVLEdBQVE7WUFDdEIsQ0FBQyxFQUFFLEdBQUc7WUFDTixDQUFDLEVBQUUsR0FBRztZQUNOLENBQUMsRUFBRSxHQUFHO1lBQ04sQ0FBQyxFQUFFLEdBQUc7U0FDVCxDQUFDO1FBcEdFLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ3JCLENBQUM7SUFFTSxLQUFLO1FBQ1IsSUFBSSxRQUFRLEdBQUcsdUJBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBVyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFM0UsUUFBUSxDQUFDLFdBQVcsQ0FBQyxVQUFTLEtBQW9CLEVBQUUsTUFBeUI7WUFDekUsSUFBSSxhQUFhLEdBQXVCLElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBRXhILGFBQWEsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQ2hELGFBQWEsQ0FBQyxhQUFhLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBRTFDLE9BQU8sS0FBSyxDQUFDO1FBQ2pCLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7UUFDMUIsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7UUFDcEIsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUVNLE9BQU87UUFDVixJQUFJLHVCQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNuQyxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQztTQUMvQjtRQUVELElBQUksSUFBSSxDQUFDLGFBQWEsS0FBSyxLQUFLLEVBQUU7WUFDOUIsT0FBTyxDQUFDLElBQUksQ0FBQywwQ0FBMEMsR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLDhDQUE4QztnQkFDcEgsZ0ZBQWdGLENBQUMsQ0FBQztZQUNsRixPQUFPO1NBQ1Y7UUFFRCxJQUFJLFFBQVEsR0FBRyx1QkFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFXLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUUzRSxJQUFJLFFBQVEsQ0FBQyxhQUFhLEtBQUssS0FBSyxFQUFFO1lBQ2xDLE9BQU8sQ0FBQyxJQUFJLENBQUMsMkZBQTJGLENBQUMsQ0FBQztZQUMxRyxPQUFPO1NBQ1Y7UUFFRCxvRUFBb0U7UUFDcEUsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUN6QixRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM1Qyx1QkFBdUI7UUFJdkIsMkJBQTJCO1FBQzNCLHFFQUFxRTtRQUNyRSxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVNLFNBQVM7UUFDWixJQUFJLElBQUksQ0FBQyxlQUFlLEtBQUssSUFBSSxFQUFFO1lBQy9CLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO1lBQzNCLElBQUksQ0FBQyxlQUFlLEdBQUcsS0FBSyxDQUFDO1NBQ2hDO0lBQ0wsQ0FBQztJQUVNLGNBQWM7UUFDakIsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDO0lBQzlCLENBQUM7SUFFTSxPQUFPO1FBQ1YsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7SUFDdkIsQ0FBQztJQUVNLFNBQVM7UUFDWixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDdkIsQ0FBQztJQUVNLGtCQUFrQjtRQUNyQixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUM7SUFDaEMsQ0FBQztJQUVNLGdCQUFnQjtRQUNuQixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQztJQUNoQyxDQUFDO0lBRU0sa0JBQWtCLENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxDQUFTLEVBQUUsQ0FBUztRQUNoRSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3RCLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN0QixJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUVNLGVBQWUsQ0FBQyxJQUFZO1FBQy9CLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO0lBQzdCLENBQUM7Q0FlSjtBQXhHRCw4QkF3R0M7QUFFRCxTQUFnQixNQUFNLENBQUMsSUFBWTtJQUMvQixPQUFPLElBQUksU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQy9CLENBQUM7QUFGRCx3QkFFQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElHYW1lVmlldyB9IGZyb20gXCIuLy4uL2dhbWUtdmlldy1pbnRlcmZhY2UuanNcIjtcclxuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tIFwiLi8uLi9jb21wb25lbnRzL3JlbmRlcmVyLmpzXCI7XHJcbmltcG9ydCB7IEdhbWVDb3JlIH0gZnJvbSBcIi4vLi4vZ2FtZS9nYW1lLWNvcmUuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBIdW1hblZpZXcgaW1wbGVtZW50cyBJR2FtZVZpZXcge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFZJbml0KCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGxldCByZW5kZXJlciA9IEdhbWVDb3JlLmdhbWUuY29tTWFuLkdldEJ5TmFtZTxSZW5kZXJlcj4odGhpcy5yZW5kZXJlck5hbWUpO1xyXG5cclxuICAgICAgICByZW5kZXJlci5DcmVhdGVTY2VuZShmdW5jdGlvbihzY2VuZTogQkFCWUxPTi5TY2VuZSwgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCk6IEJBQllMT04uU2NlbmUge1xyXG4gICAgICAgICAgICBsZXQgZGVmYXVsdENhbWVyYTogQkFCWUxPTi5GcmVlQ2FtZXJhID0gbmV3IEJBQllMT04uRnJlZUNhbWVyYShcImNhbWVyYV9kZWZhdWx0XCIsIG5ldyBCQUJZTE9OLlZlY3RvcjMoMCwgNSwgLTEwKSwgc2NlbmUpO1xyXG5cclxuICAgICAgICAgICAgZGVmYXVsdENhbWVyYS5zZXRUYXJnZXQoQkFCWUxPTi5WZWN0b3IzLlplcm8oKSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHRDYW1lcmEuYXR0YWNoQ29udHJvbChjYW52YXMsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNjZW5lO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucmVJbml0ID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFZVcGRhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKEdhbWVDb3JlLmdhbWUuUXVpdHRpbmcoKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3RTaHV0ZG93biA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJIdW1hblZpZXc6IFZVcGRhdGUoKSAtPiBUaGUgaHVtYW4gdmlldyBbXCIgKyB0aGlzLm5hbWUgKyBcIl0gY2FsbGVkIHVwZGF0ZSB3aXRob3V0IGJlaW5nIGluaXRpYWxpemVkIVxcblwiICtcclxuICAgICAgICAgICAgXCJDYWxsIHRoZSBWSW5pdCgpIGZ1bmN0aW9uIGFuZCBlbnN1cmUgaXQgcmV0dXJucyB0cnVlIGJlZm9yZSBjYWxsaW5nIFZVcGRhdGUoKS5cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCByZW5kZXJlciA9IEdhbWVDb3JlLmdhbWUuY29tTWFuLkdldEJ5TmFtZTxSZW5kZXJlcj4odGhpcy5yZW5kZXJlck5hbWUpO1xyXG5cclxuICAgICAgICBpZiAocmVuZGVyZXIuSXNJbml0aWFsaXplZCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiSHVtYW5WaWV3OiBWVXBkYXRlKCkgLT4gVGhlIGh1bWFuIHZpZXcgaGFzIGRldGVjdGVkIHRoYXQgdGhlIHJlbmRlcmVyIGlzIG5vdCBpbml0aWFsaXplZCFcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEdyYWIgYW5kIGNsZWFyIHRoZSBiYWNrZ3JvdW5kIGNvbG9yIHRvIHN0YXJ0IHRoZSBzY2VuZSByZW5kZXJpbmcuXHJcbiAgICAgICAgbGV0IGNjID0gdGhpcy5jbGVhckNvbG9yO1xyXG4gICAgICAgIHJlbmRlcmVyLkJlZ2luU2NlbmUoY2MuciwgY2MuZywgY2MuYiwgY2MuYSk7XHJcbiAgICAgICAgLy8gUmVuZGVyIG9iamVjdHMgaGVyZTpcclxuXHJcblxyXG5cclxuICAgICAgICAvLyBFbmQgcmVuZGVyaW5nIG9iamVjdHMuLi5cclxuICAgICAgICAvLyBDYWxsIHRoaXMgdG8gZW5kIHRoZSByZW5kZXJpbmcgc2NlbmUgYW5kIHByZXNlbnQgaXQgdG8gdGhlIHNjcmVlbi5cclxuICAgICAgICByZW5kZXJlci5FbmRTY2VuZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBWU2h1dGRvd24oKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMucmVxdWVzdFNodXRkb3duID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3RTaHV0ZG93biA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgVklzSW5pdGlhbGl6ZWQoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNJbml0aWFsaXplZDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgVlJlSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnJlSW5pdCA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFZJc1JlSW5pdCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZUluaXQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFZTaHV0ZG93blJlcXVlc3RlZCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0U2h1dGRvd247XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFZSZXF1ZXN0U2h1dGRvd24oKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZXF1ZXN0U2h1dGRvd24gPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBTZXRCYWNrZ3JvdW5kQ29sb3IocjogbnVtYmVyLCBnOiBudW1iZXIsIGI6IG51bWJlciwgYTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jbGVhckNvbG9yLnIgPSByO1xyXG4gICAgICAgIHRoaXMuY2xlYXJDb2xvci5nID0gZztcclxuICAgICAgICB0aGlzLmNsZWFyQ29sb3IuYiA9IGI7XHJcbiAgICAgICAgdGhpcy5jbGVhckNvbG9yLmEgPSBhO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBTZXRSZW5kZXJlck5hbWUobmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlck5hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcgPSBcIkh1bWFuVmlld1wiO1xyXG4gICAgcHVibGljIHR5cGU6IHN0cmluZyA9IFwiSHVtYW5WaWV3XCI7XHJcbiAgICBwdWJsaWMgYXV0b1VwZGF0ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHVibGljIHJlSW5pdDogYm9vbGVhbiA9IHRydWU7XHJcbiAgICBwdWJsaWMgcmVxdWVzdFNodXRkb3duOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIHJlbmRlcmVyTmFtZTogc3RyaW5nID0gXCJcIjtcclxuICAgIHByaXZhdGUgaXNJbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBjbGVhckNvbG9yOiBhbnkgPSB7XHJcbiAgICAgICAgcjogMC4wLFxyXG4gICAgICAgIGc6IDAuMCxcclxuICAgICAgICBiOiAwLjAsXHJcbiAgICAgICAgYTogMC4wXHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gQ3JlYXRlKG5hbWU6IHN0cmluZyk6IEh1bWFuVmlldyB7XHJcbiAgICByZXR1cm4gbmV3IEh1bWFuVmlldyhuYW1lKTtcclxufVxyXG4iXX0=