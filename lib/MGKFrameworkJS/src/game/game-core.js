"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const component_manager_js_1 = require("./component-manager.js");
const electron_1 = require("electron");
var gameLoaded = false;
class GameCore {
    constructor(canvasElement, comPath, logic) {
        this.preInitFunc = null;
        this.quitting = false;
        this.exitting = false;
        this.createdComponents = [];
        this.exitCode = 0;
        this.isInitialized = false;
        this.reInit = true;
        this.gameLogic = logic;
        this._canvas = document.getElementById(canvasElement);
        this.comMan = new component_manager_js_1.ComponentManager(comPath);
    }
    static SetGameType(gameType) {
        GameCore.game = gameType;
    }
    get ReInit() {
        return this.reInit;
    }
    ReInitialize() {
        this.reInit = true;
        this.isInitialized = false;
    }
    VInit() {
        try {
            if (this.preInitFunc !== null) {
                let preState = true;
                if (this.reInit === true) {
                    preState = this.preInitFunc(this);
                }
                if (preState === true) {
                    this.comMan.Init();
                    if (!this.gameLogic.VInit()) {
                        return false;
                    }
                    if (this.reInit === true) {
                        this.reInit = false;
                        this.isInitialized = true;
                        this.VUpdate();
                    }
                }
                else {
                    this.reInit = false;
                    this.Quit();
                    return false;
                }
            }
            this.isInitialized = true;
            if (this.reInit === true) {
                this.reInit = false;
            }
            return true;
        }
        catch (err) {
            if (this.reInit === true) {
                this.isInitialized = false;
                this.reInit = false;
            }
            console.error("GameCore: VInit() -> ### ERROR:\n" + err);
            return false;
        }
    }
    VUpdate() {
        if (!this.quitting) {
            if (this.reInit === true) {
                return;
            }
            if (this.isInitialized === false) {
                return;
            }
            // Update components
            this.comMan.Update();
            this.gameLogic.VUpdate();
            // Get the current window and define how its events are handled.
            let _window = electron_1.remote.getCurrentWindow();
            _window.on("close", () => {
                this.Exit();
            });
        }
    }
    VShutdown() {
        this.gameLogic.VShutdown();
        this.comMan.Shutdown();
        if (this.quitting === true) {
            this.comMan.Clear();
            process.exit(this.exitCode);
        }
    }
    // Returns wether the program is terminating or still running
    Quitting() {
        return this.quitting;
    }
    // Tell engine to start shutting down and then terminate
    Quit() {
        this.quitting = true;
    }
    // Returns whether the user requested to exit
    Exitting() {
        return this.exitting;
    }
    // The user requested to exit
    Exit() {
        this.exitting = true;
    }
    // The user decided not to exit after initial exit request... (make up your mind!!!)
    CancelExit() {
        this.exitting = false;
    }
}
exports.GameCore = GameCore;
var loadGame;
function OnDOMContentLoaded(cbLoadGame) {
    loadGame = cbLoadGame;
}
exports.OnDOMContentLoaded = OnDOMContentLoaded;
window.addEventListener('DOMContentLoaded', () => {
    if (!gameLoaded) {
        loadGame();
        gameLoaded = true;
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FtZS1jb3JlLmpzIiwic291cmNlUm9vdCI6Ii4vLi4vIiwic291cmNlcyI6WyJNR0tGcmFtZXdvcmtKUy9zcmMvZ2FtZS9nYW1lLWNvcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxpRUFBMEQ7QUFDMUQsdUNBQWlFO0FBR2pFLElBQUksVUFBVSxHQUFZLEtBQUssQ0FBQztBQUVoQyxNQUFhLFFBQVE7SUFrQmpCLFlBQVksYUFBcUIsRUFBRSxPQUFlLEVBQUUsS0FBb0I7UUFqQmpFLGdCQUFXLEdBQWEsSUFBSSxDQUFDO1FBRzFCLGFBQVEsR0FBWSxLQUFLLENBQUM7UUFDMUIsYUFBUSxHQUFZLEtBQUssQ0FBQztRQUM3QixzQkFBaUIsR0FBYSxFQUFFLENBQUM7UUFDOUIsYUFBUSxHQUFXLENBQUMsQ0FBQztRQUVyQixrQkFBYSxHQUFZLEtBQUssQ0FBQztRQUMvQixXQUFNLEdBQVksSUFBSSxDQUFDO1FBUzdCLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxPQUFPLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQXNCLENBQUM7UUFDM0UsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLHVDQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2hELENBQUM7SUFSRCxNQUFNLENBQUMsV0FBVyxDQUFJLFFBQVc7UUFDN0IsUUFBUSxDQUFDLElBQUksR0FBRyxRQUErQixDQUFDO0lBQ3BELENBQUM7SUFRRCxJQUFXLE1BQU07UUFDYixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDdkIsQ0FBQztJQUVNLFlBQVk7UUFDZixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUNuQixJQUFJLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQztJQUMvQixDQUFDO0lBRU0sS0FBSztRQUNSLElBQUk7WUFDQSxJQUFJLElBQUksQ0FBQyxXQUFXLEtBQUssSUFBSSxFQUFFO2dCQUMzQixJQUFJLFFBQVEs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O1FBQ1AsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7SUFDekIsQ0FBQztJQUVELG9GQUFvRjtJQUM3RSxVQUFVO1FBQ2IsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7SUFDMUIsQ0FBQztDQUNKO0FBcklELDRCQXFJQztBQUVELElBQUksUUFBa0IsQ0FBQztBQUV2QixTQUFnQixrQkFBa0IsQ0FBQyxVQUFvQjtJQUNuRCxRQUFRLEdBQUcsVUFBVSxDQUFDO0FBQzFCLENBQUM7QUFGRCxnREFFQztBQUVELE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7SUFDN0MsSUFBSSxDQUFDLFVBQVUsRUFBQztRQUNaLFFBQVEsRUFBRSxDQUFDO1FBQ1gsVUFBVSxHQUFHLElBQUksQ0FBQztLQUNyQjtBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50TWFuYWdlciB9IGZyb20gXCIuL2NvbXBvbmVudC1tYW5hZ2VyLmpzXCI7XHJcbmltcG9ydCB7IHJlbW90ZSwgQnJvd3NlcldpbmRvdywgVG91Y2hCYXJTbGlkZXIgfSBmcm9tIFwiZWxlY3Ryb25cIjtcclxuaW1wb3J0IHsgQmFzZUdhbWVMb2dpYyB9IGZyb20gXCIuLy4uL2dhbWUtbG9naWMvYmFzZS1nYW1lLWxvZ2ljLmpzXCI7XHJcblxyXG52YXIgZ2FtZUxvYWRlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWVDb3JlIHtcclxuICAgIHB1YmxpYyBwcmVJbml0RnVuYzogRnVuY3Rpb24gPSBudWxsO1xyXG4gICAgcHVibGljIF9jYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xyXG4gICAgcHVibGljIGNvbU1hbjogQ29tcG9uZW50TWFuYWdlcjtcclxuICAgIHByb3RlY3RlZCBxdWl0dGluZzogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJvdGVjdGVkIGV4aXR0aW5nOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwdWJsaWMgY3JlYXRlZENvbXBvbmVudHM6IHN0cmluZ1tdID0gW107XHJcbiAgICBwcm90ZWN0ZWQgZXhpdENvZGU6IG51bWJlciA9IDA7XHJcbiAgICBwdWJsaWMgZ2FtZUxvZ2ljOiBCYXNlR2FtZUxvZ2ljO1xyXG4gICAgcHJvdGVjdGVkIGlzSW5pdGlhbGl6ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByb3RlY3RlZCByZUluaXQ6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICAgIHN0YXRpYyBnYW1lOiBHYW1lQ29yZTtcclxuXHJcbiAgICBzdGF0aWMgU2V0R2FtZVR5cGU8VD4oZ2FtZVR5cGU6IFQpOiB2b2lkIHtcclxuICAgICAgICBHYW1lQ29yZS5nYW1lID0gZ2FtZVR5cGUgYXMgdW5rbm93biBhcyBHYW1lQ29yZTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihjYW52YXNFbGVtZW50OiBzdHJpbmcsIGNvbVBhdGg6IHN0cmluZywgbG9naWM6IEJhc2VHYW1lTG9naWMpIHtcclxuICAgICAgICB0aGlzLmdhbWVMb2dpYyA9IGxvZ2ljO1xyXG4gICAgICAgIHRoaXMuX2NhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhbnZhc0VsZW1lbnQpIGFzIEhUTUxDYW52YXNFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuY29tTWFuID0gbmV3IENvbXBvbmVudE1hbmFnZXIoY29tUGF0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldCBSZUluaXQoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVJbml0O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBSZUluaXRpYWxpemUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZUluaXQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBWSW5pdCgpOiBib29sZWFuIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wcmVJbml0RnVuYyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHByZVN0YXRlOiBib29sZWFuID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlSW5pdCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZVN0YXRlID0gdGhpcy5wcmVJbml0RnVuYyh0aGlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocHJlU3RhdGUgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbU1hbi5Jbml0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5nYW1lTG9naWMuVkluaXQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yZUluaXQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZUluaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5WVXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlSW5pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuUXVpdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMucmVJbml0ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlSW5pdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5yZUluaXQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZUluaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkdhbWVDb3JlOiBWSW5pdCgpIC0+ICMjIyBFUlJPUjpcXG5cIiArIGVycik7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFZVcGRhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnF1aXR0aW5nKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJlSW5pdCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgY29tcG9uZW50c1xyXG4gICAgICAgICAgICB0aGlzLmNvbU1hbi5VcGRhdGUoKTtcclxuICAgICAgICAgICAgdGhpcy5nYW1lTG9naWMuVlVwZGF0ZSgpO1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IHRoZSBjdXJyZW50IHdpbmRvdyBhbmQgZGVmaW5lIGhvdyBpdHMgZXZlbnRzIGFyZSBoYW5kbGVkLlxyXG4gICAgICAgICAgICBsZXQgX3dpbmRvdzogQnJvd3NlcldpbmRvdyA9IHJlbW90ZS5nZXRDdXJyZW50V2luZG93KCk7XHJcbiAgICAgICAgICAgIF93aW5kb3cub24oXCJjbG9zZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkV4aXQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBWU2h1dGRvd24oKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nYW1lTG9naWMuVlNodXRkb3duKCk7XHJcbiAgICAgICAgdGhpcy5jb21NYW4uU2h1dGRvd24oKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucXVpdHRpbmcgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgdGhpcy5jb21NYW4uQ2xlYXIoKTtcclxuICAgICAgICAgICAgcHJvY2Vzcy5leGl0KHRoaXMuZXhpdENvZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm5zIHdldGhlciB0aGUgcHJvZ3JhbSBpcyB0ZXJtaW5hdGluZyBvciBzdGlsbCBydW5uaW5nXHJcbiAgICBwdWJsaWMgUXVpdHRpbmcoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucXVpdHRpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVGVsbCBlbmdpbmUgdG8gc3RhcnQgc2h1dHRpbmcgZG93biBhbmQgdGhlbiB0ZXJtaW5hdGVcclxuICAgIHB1YmxpYyBRdWl0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucXVpdHRpbmcgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJldHVybnMgd2hldGhlciB0aGUgdXNlciByZXF1ZXN0ZWQgdG8gZXhpdFxyXG4gICAgcHVibGljIEV4aXR0aW5nKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmV4aXR0aW5nO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRoZSB1c2VyIHJlcXVlc3RlZCB0byBleGl0XHJcbiAgICBwdWJsaWMgRXhpdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmV4aXR0aW5nID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUaGUgdXNlciBkZWNpZGVkIG5vdCB0byBleGl0IGFmdGVyIGluaXRpYWwgZXhpdCByZXF1ZXN0Li4uIChtYWtlIHVwIHlvdXIgbWluZCEhISlcclxuICAgIHB1YmxpYyBDYW5jZWxFeGl0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZXhpdHRpbmcgPSBmYWxzZTtcclxuICAgIH1cclxufVxyXG5cclxudmFyIGxvYWRHYW1lOiBGdW5jdGlvbjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBPbkRPTUNvbnRlbnRMb2FkZWQoY2JMb2FkR2FtZTogRnVuY3Rpb24pOiB2b2lkIHtcclxuICAgIGxvYWRHYW1lID0gY2JMb2FkR2FtZTtcclxufVxyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XHJcbiAgICBpZiAoIWdhbWVMb2FkZWQpe1xyXG4gICAgICAgIGxvYWRHYW1lKCk7XHJcbiAgICAgICAgZ2FtZUxvYWRlZCA9IHRydWU7XHJcbiAgICB9XHJcbn0pOyJdfQ==