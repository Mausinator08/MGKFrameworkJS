"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.OnDOMContentLoaded = exports.GameCore = void 0;
const component_manager_js_1 = require("./component-manager.js");
const electron_1 = require("electron");
var gameLoaded = false;
class GameCore {
    constructor(canvasElement, comPath, logic) {
        this.preInitFunc = null;
        this.quitting = false;
        this.exitting = false;
        this.createdComponents = [];
        this.exitCode = 0;
        this.isInitialized = false;
        this.reInit = true;
        this.gameLogic = logic;
        this._canvas = document.getElementById(canvasElement);
        this.comMan = new component_manager_js_1.ComponentManager(comPath);
    }
    static SetGameType(gameType) {
        GameCore.game = gameType;
    }
    get ReInit() {
        return this.reInit;
    }
    ReInitialize() {
        this.reInit = true;
        this.isInitialized = false;
    }
    VInit() {
        try {
            if (this.preInitFunc !== null) {
                let preState = true;
                if (this.reInit === true) {
                    preState = this.preInitFunc(this);
                }
                if (preState === true) {
                    this.comMan.Init();
                    if (!this.gameLogic.VInit()) {
                        return false;
                    }
                    if (this.reInit === true) {
                        this.reInit = false;
                        this.isInitialized = true;
                        this.VUpdate();
                    }
                }
                else {
                    this.reInit = false;
                    this.Quit();
                    return false;
                }
            }
            this.isInitialized = true;
            if (this.reInit === true) {
                this.reInit = false;
            }
            return true;
        }
        catch (err) {
            if (this.reInit === true) {
                this.isInitialized = false;
                this.reInit = false;
            }
            console.error("GameCore: VInit() -> ### ERROR:\n" + err);
            return false;
        }
    }
    VUpdate() {
        if (!this.quitting) {
            if (this.reInit === true) {
                return;
            }
            if (this.isInitialized === false) {
                return;
            }
            // Update components
            this.comMan.Update();
            this.gameLogic.VUpdate();
            // Get the current window and define how its events are handled.
            let _window = electron_1.remote.getCurrentWindow();
            _window.on("close", () => {
                this.Exit();
            });
        }
    }
    VShutdown() {
        this.gameLogic.VShutdown();
        this.comMan.Shutdown();
        if (this.quitting === true) {
            this.comMan.Clear();
            process.exit(this.exitCode);
        }
    }
    // Returns wether the program is terminating or still running
    Quitting() {
        return this.quitting;
    }
    // Tell engine to start shutting down and then terminate
    Quit() {
        this.quitting = true;
    }
    // Returns whether the user requested to exit
    Exitting() {
        return this.exitting;
    }
    // The user requested to exit
    Exit() {
        this.exitting = true;
    }
    // The user decided not to exit after initial exit request... (make up your mind!!!)
    CancelExit() {
        this.exitting = false;
    }
}
exports.GameCore = GameCore;
var loadGame;
function OnDOMContentLoaded(cbLoadGame) {
    loadGame = cbLoadGame;
}
exports.OnDOMContentLoaded = OnDOMContentLoaded;
window.addEventListener('DOMContentLoaded', () => {
    if (!gameLoaded) {
        loadGame();
        gameLoaded = true;
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FtZS1jb3JlLmpzIiwic291cmNlUm9vdCI6Ii4vLi4vIiwic291cmNlcyI6WyJNR0tGcmFtZXdvcmtKUy9zcmMvZ2FtZS9nYW1lLWNvcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsaUVBQTBEO0FBQzFELHVDQUFpRTtBQUdqRSxJQUFJLFVBQVUsR0FBWSxLQUFLLENBQUM7QUFFaEMsTUFBYSxRQUFRO0lBa0JqQixZQUFZLGFBQXFCLEVBQUUsT0FBZSxFQUFFLEtBQW9CO1FBakJqRSxnQkFBVyxHQUFhLElBQUksQ0FBQztRQUcxQixhQUFRLEdBQVksS0FBSyxDQUFDO1FBQzFCLGFBQVEsR0FBWSxLQUFLLENBQUM7UUFDN0Isc0JBQWlCLEdBQWEsRUFBRSxDQUFDO1FBQzlCLGFBQVEsR0FBVyxDQUFDLENBQUM7UUFFckIsa0JBQWEsR0FBWSxLQUFLLENBQUM7UUFDL0IsV0FBTSxHQUFZLElBQUksQ0FBQztRQVM3QixJQUFJLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztRQUN2QixJQUFJLENBQUMsT0FBTyxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFzQixDQUFDO1FBQzNFLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSx1Q0FBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBUkQsTUFBTSxDQUFDLFdBQVcsQ0FBSSxRQUFXO1FBQzdCLFFBQVEsQ0FBQyxJQUFJLEdBQUcsUUFBK0IsQ0FBQztJQUNwRCxDQUFDO0lBUUQsSUFBVyxNQUFNO1FBQ2IsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3ZCLENBQUM7SUFFTSxZQUFZO1FBQ2YsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7UUFDbkIsSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7SUFDL0IsQ0FBQztJQUVNLEtBQUs7UUFDUixJQUFJO1lBQ0EsSUFBSSxJQUFJLENBQUMsV0FBVyxLQUFLLElBQUksRUFBRTtnQkFDM0IsSUFBSSxRQUFR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STtRQUNQLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxvRkFBb0Y7SUFDN0UsVUFBVTtRQUNiLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDO0lBQzFCLENBQUM7Q0FDSjtBQXJJRCw0QkFxSUM7QUFFRCxJQUFJLFFBQWtCLENBQUM7QUFFdkIsU0FBZ0Isa0JBQWtCLENBQUMsVUFBb0I7SUFDbkQsUUFBUSxHQUFHLFVBQVUsQ0FBQztBQUMxQixDQUFDO0FBRkQsZ0RBRUM7QUFFRCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO0lBQzdDLElBQUksQ0FBQyxVQUFVLEVBQUM7UUFDWixRQUFRLEVBQUUsQ0FBQztRQUNYLFVBQVUsR0FBRyxJQUFJLENBQUM7S0FDckI7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudE1hbmFnZXIgfSBmcm9tIFwiLi9jb21wb25lbnQtbWFuYWdlci5qc1wiO1xyXG5pbXBvcnQgeyByZW1vdGUsIEJyb3dzZXJXaW5kb3csIFRvdWNoQmFyU2xpZGVyIH0gZnJvbSBcImVsZWN0cm9uXCI7XHJcbmltcG9ydCB7IEJhc2VHYW1lTG9naWMgfSBmcm9tIFwiLi8uLi9nYW1lLWxvZ2ljL2Jhc2UtZ2FtZS1sb2dpYy5qc1wiO1xyXG5cclxudmFyIGdhbWVMb2FkZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbmV4cG9ydCBjbGFzcyBHYW1lQ29yZSB7XHJcbiAgICBwdWJsaWMgcHJlSW5pdEZ1bmM6IEZ1bmN0aW9uID0gbnVsbDtcclxuICAgIHB1YmxpYyBfY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcclxuICAgIHB1YmxpYyBjb21NYW46IENvbXBvbmVudE1hbmFnZXI7XHJcbiAgICBwcm90ZWN0ZWQgcXVpdHRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByb3RlY3RlZCBleGl0dGluZzogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHVibGljIGNyZWF0ZWRDb21wb25lbnRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgcHJvdGVjdGVkIGV4aXRDb2RlOiBudW1iZXIgPSAwO1xyXG4gICAgcHVibGljIGdhbWVMb2dpYzogQmFzZUdhbWVMb2dpYztcclxuICAgIHByb3RlY3RlZCBpc0luaXRpYWxpemVkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcm90ZWN0ZWQgcmVJbml0OiBib29sZWFuID0gdHJ1ZTtcclxuXHJcbiAgICBzdGF0aWMgZ2FtZTogR2FtZUNvcmU7XHJcblxyXG4gICAgc3RhdGljIFNldEdhbWVUeXBlPFQ+KGdhbWVUeXBlOiBUKTogdm9pZCB7XHJcbiAgICAgICAgR2FtZUNvcmUuZ2FtZSA9IGdhbWVUeXBlIGFzIHVua25vd24gYXMgR2FtZUNvcmU7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoY2FudmFzRWxlbWVudDogc3RyaW5nLCBjb21QYXRoOiBzdHJpbmcsIGxvZ2ljOiBCYXNlR2FtZUxvZ2ljKSB7XHJcbiAgICAgICAgdGhpcy5nYW1lTG9naWMgPSBsb2dpYztcclxuICAgICAgICB0aGlzLl9jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYW52YXNFbGVtZW50KSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuICAgICAgICB0aGlzLmNvbU1hbiA9IG5ldyBDb21wb25lbnRNYW5hZ2VyKGNvbVBhdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgUmVJbml0KCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlSW5pdDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgUmVJbml0aWFsaXplKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucmVJbml0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgVkluaXQoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucHJlSW5pdEZ1bmMgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGxldCBwcmVTdGF0ZTogYm9vbGVhbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZUluaXQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBwcmVTdGF0ZSA9IHRoaXMucHJlSW5pdEZ1bmModGhpcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHByZVN0YXRlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21NYW4uSW5pdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZ2FtZUxvZ2ljLlZJbml0KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVJbml0ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVJbml0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuVlVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZUluaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLlF1aXQoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJlSW5pdCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZUluaXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucmVJbml0ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVJbml0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJHYW1lQ29yZTogVkluaXQoKSAtPiAjIyMgRVJST1I6XFxuXCIgKyBlcnIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBWVXBkYXRlKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICghdGhpcy5xdWl0dGluZykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5yZUluaXQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVXBkYXRlIGNvbXBvbmVudHNcclxuICAgICAgICAgICAgdGhpcy5jb21NYW4uVXBkYXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZUxvZ2ljLlZVcGRhdGUoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEdldCB0aGUgY3VycmVudCB3aW5kb3cgYW5kIGRlZmluZSBob3cgaXRzIGV2ZW50cyBhcmUgaGFuZGxlZC5cclxuICAgICAgICAgICAgbGV0IF93aW5kb3c6IEJyb3dzZXJXaW5kb3cgPSByZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpO1xyXG4gICAgICAgICAgICBfd2luZG93Lm9uKFwiY2xvc2VcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5FeGl0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgVlNodXRkb3duKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2FtZUxvZ2ljLlZTaHV0ZG93bigpO1xyXG4gICAgICAgIHRoaXMuY29tTWFuLlNodXRkb3duKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnF1aXR0aW5nID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tTWFuLkNsZWFyKCk7XHJcbiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCh0aGlzLmV4aXRDb2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJucyB3ZXRoZXIgdGhlIHByb2dyYW0gaXMgdGVybWluYXRpbmcgb3Igc3RpbGwgcnVubmluZ1xyXG4gICAgcHVibGljIFF1aXR0aW5nKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnF1aXR0aW5nO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFRlbGwgZW5naW5lIHRvIHN0YXJ0IHNodXR0aW5nIGRvd24gYW5kIHRoZW4gdGVybWluYXRlXHJcbiAgICBwdWJsaWMgUXVpdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnF1aXR0aW5nID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm5zIHdoZXRoZXIgdGhlIHVzZXIgcmVxdWVzdGVkIHRvIGV4aXRcclxuICAgIHB1YmxpYyBFeGl0dGluZygpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5leGl0dGluZztcclxuICAgIH1cclxuXHJcbiAgICAvLyBUaGUgdXNlciByZXF1ZXN0ZWQgdG8gZXhpdFxyXG4gICAgcHVibGljIEV4aXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5leGl0dGluZyA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVGhlIHVzZXIgZGVjaWRlZCBub3QgdG8gZXhpdCBhZnRlciBpbml0aWFsIGV4aXQgcmVxdWVzdC4uLiAobWFrZSB1cCB5b3VyIG1pbmQhISEpXHJcbiAgICBwdWJsaWMgQ2FuY2VsRXhpdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmV4aXR0aW5nID0gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuXHJcbnZhciBsb2FkR2FtZTogRnVuY3Rpb247XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gT25ET01Db250ZW50TG9hZGVkKGNiTG9hZEdhbWU6IEZ1bmN0aW9uKTogdm9pZCB7XHJcbiAgICBsb2FkR2FtZSA9IGNiTG9hZEdhbWU7XHJcbn1cclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xyXG4gICAgaWYgKCFnYW1lTG9hZGVkKXtcclxuICAgICAgICBsb2FkR2FtZSgpO1xyXG4gICAgICAgIGdhbWVMb2FkZWQgPSB0cnVlO1xyXG4gICAgfVxyXG59KTsiXX0=